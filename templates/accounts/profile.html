{% extends 'base.html' %}

{% block title %}>_ PROFILE // {{ user.username }}{% endblock title %}

{% block content %}
<div class="container">
    <div class="page-header">
        <h1 class="page-title">> USER_PROFILE</h1>
        <p class="page-subtitle">System user information and credentials</p>
    </div>

    <div class="profile-dashboard">
        <!-- Sidebar Card -->
        <div class="profile-card">
            <div class="profile-avatar">
                <i class="fas fa-user-astronaut"></i>
            </div>
            
            <h2 class="profile-name">{{ user.username }}</h2>

            <div class="profile-actions">
                <button type="button" class="btn-primary" id="toggleEditProfile" style="width: 100%; margin-top: 12px; justify-content: center; display: flex;">
                    <i class="fas fa-cog" style="margin-right: 8px;"></i> EDIT_PROFILE
                </button>
            </div>
        </div>

        <!-- Main Details -->
        <div class="profile-details-panel">
            <h3 class="profile-group-title"><i class="fas fa-database"></i> [ OVERVIEW ]</h3>
            
            <div class="data-grid">
                <div class="data-item">
                    <span class="data-label"><i class="fas fa-id-badge"></i> USERNAME</span>
                    <div class="data-value">{{ user.username }}</div>
                </div>

                <div class="data-item">
                    <span class="data-label"><i class="fas fa-envelope"></i> EMAIL_ADDRESS</span>
                    <div class="data-value">{{ user.email|default:"NOT_SET" }}</div>
                </div>

                <div class="data-item">
                    <span class="data-label"><i class="fas fa-signature"></i> FIRST_NAME</span>
                    <div class="data-value">{{ user.first_name|default:"NOT_SET" }}</div>
                </div>

                <div class="data-item">
                    <span class="data-label"><i class="fas fa-signature"></i> LAST_NAME</span>
                    <div class="data-value">{{ user.last_name|default:"NOT_SET" }}</div>
                </div>
            </div>
            
            <div class="data-grid">
                <div class="data-item">
                    <span class="data-label"><i class="fas fa-calendar-plus"></i> REGISTRATION_DATE</span>
                    <div class="data-value">{{ user.date_joined|date:"Y-m-d H:i:s" }}</div>
                </div>
            </div>
            
        </div>
    </div>

    <!-- Edit Profile Module (Hidden by default) -->
    <div id="edit-profile-section" class="panel-section" style="display: none; animation: slideUp 0.3s ease-out;">
        <div class="section-header">
             <h2 class="section-title">[ UPDATE_CREDENTIALS ]</h2>
        </div>
        <form method="post">
            {% csrf_token %}
            <div class="form-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 24px;">
                 {% for field in form %}
                 <div class="input-wrapper" {% if field.name == 'address' %}style="grid-column: 1 / -1"{% endif %}>
                     <label class="input-label">{{ field.label }}</label>
                     {{ field }}
                     {% if field.errors %}
                     <ul class="errorlist">
                        {% for error in field.errors %}
                            <li>{{ error }}</li>
                        {% endfor %}
                     </ul>
                     {% endif %}
                 </div>
                 {% endfor %}
            </div>
            <div style="margin-top: 24px; display: flex; gap: 16px; justify-content: flex-end;">
                 <button type="button" class="btn-secondary" id="cancelEdit">CANCEL_UPDATE</button>
                 <button type="submit" class="btn-primary">SAVE_CHANGES</button>
            </div>
        </form>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const toggleBtn = document.getElementById('toggleEditProfile');
        const editSection = document.getElementById('edit-profile-section');
        const cancelBtn = document.getElementById('cancelEdit');
        
        if (toggleBtn && editSection) {
            toggleBtn.addEventListener('click', () => {
                 editSection.style.display = 'block';
                 // Smooth scroll to the edit section
                 setTimeout(() => {
                     editSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                 }, 100);
            });
            
            cancelBtn.addEventListener('click', () => {
                 editSection.style.display = 'none';
                 window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        }
    });
</script>
{% endblock content %}

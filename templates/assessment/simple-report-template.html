<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Assessment Report</title>
    <style>
        @page {
            size: A4;
            margin: 1.5cm;
        }

        body {
            font-family: Helvetica, sans-serif;
            font-size: 10pt;
            line-height: 1.5;
            color: #333;
        }

        h1 {
            font-size: 24pt;
            color: #161B22; /* Text Dark */
            text-align: center;
            margin-bottom: 20px;
            text-transform: uppercase;
        }

        h2 {
            font-size: 16pt;
            color: #161B22;
            border-bottom: 2px solid #00E396; /* Neon Green Accent */
            padding-bottom: 5px;
            margin-top: 30px;
            margin-bottom: 15px;
        }

        /* Header Table */
        .info-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
            border: 1px solid #ccc;
        }
        
        .info-table td {
            padding: 10px;
            border: 1px solid #ccc;
            vertical-align: top;
        }

        .label {
            font-weight: bold;
            color: #666;
            font-size: 9pt;
            text-transform: uppercase;
        }

        .value {
            font-size: 11pt;
            color: #000;
        }

        /* Vulnerability Box */
        .vuln-container {
            border: 1px solid #ddd;
            background-color: #f9f9f9;
            margin-bottom: 20px;
            padding: 0;
            page-break-inside: avoid;
        }

        .vuln-header {
            background-color: #161B22;
            color: #fff;
            padding: 8px 12px;
            font-weight: bold;
            font-size: 11pt;
            border-bottom: 1px solid #000;
        }

        .vuln-body {
            padding: 12px;
        }

        .severity-badge {
            color: #fff;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 9pt;
            font-weight: bold;
            text-transform: uppercase;
        }
        
        .sev-info { background-color: #00E5FF; color: #000; }
        .sev-low { background-color: #00E396; color: #000; }
        .sev-medium { background-color: #FFD600; color: #000; }
        .sev-high { background-color: #FF6B35; color: #000; }
        .sev-critical { background-color: #FF0055; color: #fff; }

        .meta-row {
            margin-bottom: 5px;
        }
        
        .meta-key {
            font-weight: bold;
            font-size: 9pt;
            color: #555;
            width: 120px;
            display: inline-block;
        }

        .description-box {
            margin-top: 10px;
            padding: 10px;
            background-color: #fff;
            border: 1px solid #eee;
        }

        .ref-list {
            margin-top: 5px;
            padding-left: 20px;
        }
        
        a { color: #00E5FF; text-decoration: none; }
    </style>
</head>
<body>

    <h1>Simple Assessment Report</h1>

    <table class="info-table">
        <tr>
            <td width="33%">
                <div class="label">Client</div>
                <div class="value">{{ assessment.client.get_full_name }}</div>
            </td>
            <td width="33%">
                <div class="label">Target Website</div>
                <div class="value">{{ assessment.website }}</div>
            </td>
            <td width="33%">
                <div class="label">Assessed On</div>
                <div class="value">{{ assessment.tested_on|date:"Y-m-d H:i" }}</div>
            </td>
        </tr>
    </table>

    <h2>Identified Vulnerabilities</h2>

    {% if nuclei_logs %}
        {% for log in nuclei_logs %}
        <div class="vuln-container">
            <div class="vuln-header">
                <span class="severity-badge sev-{{ log.info.severity|lower|default:'info' }}">
                    {{ log.info.severity|upper|default:"INFO" }}
                </span>
                &nbsp;&nbsp;
                {{ log.info.name|default:log.template_id }}
            </div>
            
            <div class="vuln-body">
                <div class="meta-row">
                    <span class="meta-key">Template ID:</span> {{ log.template_id }}
                </div>
                <!-- Removed matched_at, type if not needed in simple -->
                <!-- Simple report often just wants names and descriptions -->
                
                {% if log.host %}
                <div class="meta-row">
                    <span class="meta-key">Host:</span> {{ log.host }}
                </div>
                {% endif %}

                {% if log.info.description %}
                <div class="description-box">
                    <strong>Description:</strong><br/>
                    {{ log.info.description }}
                </div>
                {% endif %}
                
                <!-- References are usually OK in simple reports -->
                {% if log.info.reference %}
                <div style="margin-top: 10px;">
                    <strong>References:</strong>
                    <ul class="ref-list">
                    {% for ref in log.info.reference %}
                        <li><a href="{{ ref }}">{{ ref }}</a></li>
                    {% endfor %}
                    </ul>
                </div>
                {% endif %}
            </div>
        </div>
        {% endfor %}
    {% else %}
        <div style="text-align: center; padding: 50px; background-color: #f9f9f9;">
            <h3>No Vulnerabilities Found</h3>
            <p>The scan did not detect any issues matching the current profile.</p>
        </div>
    {% endif %}

</body>
</html>